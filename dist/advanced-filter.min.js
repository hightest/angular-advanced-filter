/*!
 * angular-ht-advanced-filter
 * https://github.com/hightest/angular-advanced-filter
 * Version: 0.0.1 - 2015-04-14T09:50:41.008Z
 * License: 
 */
!function(){function e(e,t,n){function r(e){for(var t={},n=e.length,r=0;n>r;++r){var i=e[r];i.value.length&&(angular.isUndefined(t[i.filter])&&(t[i.filter]={}),angular.isDefined(t[i.filter][i.field])?(Array.isArray(t[i.filter][i.field])||(t[i.filter][i.field]=[t[i.filter][i.field]]),t[i.filter][i.field].push(i.value)):t[i.filter][i.field]=i.value)}return t}function i(e){for(var t=v.select,n=t.length,r=0;n>r;++r)for(var i=t[r],l=i.options.length,a=0;l>a;++a){var f=i.options[a];if(angular.isDefined(f.selected)&&f.selected){var o=f.type,s=f.field,u=f.value;angular.isDefined(e[o])||(e[o]={}),angular.isDefined(e[o][s])&&(e[o][s].length>0||angular.isNumber(e[o][s]))?(Array.isArray(e[o][s])||(e[o][s]=[e[o][s]]),e[o][s].push(u)):e[o][s]=u}}return e}function l(e){var t=[];return angular.forEach(e,function(n,r){Array.isArray(n)&&angular.forEach(n,function(n){var i=angular.copy(e);i[r]=n,t=t.concat(l(i))})}),0===t.length&&t.push(e),t}function a(){y&&n.cancel(y),y=n(s,500)}function f(e,t,n,r){var i=e.indexOf(".");if(-1===i)r?("undefined"==typeof n[r]&&(n[r]={}),n[r][e]=t):n[e]=t;else{var l=e.split(".",1)[0],a=e.substr(i+1);r&&("undefined"==typeof n[r]&&(n[r]={}),n=n[r]),f(a,t,n,l)}}function o(e){for(var t={},n=Object.keys(e),r=0,i=n.length;i>r;r++)f(n[r],e[n[r]],t);return t}function s(){var e=p.slice(),n=r(v.filters);n=i(n);for(var a in n)if(n.hasOwnProperty(a)){var f=n[a];if(f=l(f),1===f.length)if(f[0]=o(f[0]),"filter"==a&&angular.isDefined(f[0].$)&&f[0].$.length)for(var s=f[0].$,u=s.split(" "),c=0;c<u.length;c++)f[0].$=u[c],e=t(a)(e,f[0]);else e=t(a)(e,f[0]);else{for(var d=[],g=f.length,y=0;g>y;y++){var b=e.slice();if("filter"==a&&angular.isDefined(f[y].$)&&f[y].$.length)for(var $=f[y].$,T=$.split(" "),D=0;D<T.length;D++)f[y].$=T[D],b=t(a)(b,f[y]);else b=t(a)(b,f[y]);d=d.concat(b)}for(y=0;y<d.length;y++)for(var j=y+1;j<d.length;j++)d[y]==d[j]&&d.splice(j--,1);e=d}}h.length=0;for(var A=0;A<e.length;A++)h.push(e[A]);m()}function u(){a()}function c(e){v.filters.splice(e,1),s()}function d(){v.filters.push({filter:v.filterTypes[0].value,field:"$",value:""})}var v=this,g=e.htAdvancedFilter,p=g.data,h=g.filteredData;v.fields=[{name:"Wszędzie",value:"$"}],v.fields=v.fields.concat(g.fields),v.select=angular.isDefined(g.select)?g.select:[],v.filters=angular.isDefined(g.filters)?g.filters:[];var m=angular.isDefined(g.onUpdate)?g.onUpdate:function(){};v.filterTypes=[{name:"Szukaj w",value:"filter"},{name:"Mniejszy od",value:"lessThanOrEqualTo"},{name:"Większy od",value:"greaterThanOrEqualTo"}],v.add=d,v.update=u,v.remove=c,s(),g.disableDefaultFilter||d(),e.$watch(function(){return p},function(e,t){e!=t&&a()},!0);var y=null}function t(){return{require:"^ngModel",scope:{htAdvancedFilter:"="},controllerAs:"filter",templateUrl:"advanced-filter.html",controller:e}}function n(e){return function(t,n){return e(t,n,function(e,t){var n=function(e){return!isNaN(parseFloat(e))};return n(e)&&n(t)?e>=t:!1})}}function r(e){return function(t,n){return e(t,n,function(e,t){var n=function(e){return!isNaN(parseFloat(e))};return n(e)&&n(t)?t>=e:!1})}}function i(){return function(e,t){t[0].focus()}}e.$inject=["$scope","$filter","$timeout"],n.$inject=["filterFilter"],r.$inject=["filterFilter"],angular.module("ht.advanced-filter",["ui.bootstrap"]).directive("htAdvancedFilter",t).directive("htFocus",i).filter("greaterThanOrEqualTo",n).filter("lessThanOrEqualTo",r)}(),angular.module("ht.advanced-filter").run(["$templateCache",function(e){e.put("advanced-filter.html",'<div><div class="form-inline" ng-repeat="object in filter.filters"><div class="form-group"><select class="form-control" ng-model="object.filter" ng-change="filter.update()" ng-options="filterType.value as filterType.name for filterType in filter.filterTypes"></select></div><div class="form-group"><select class="form-control" ng-model="object.field" ng-change="filter.update()" ng-options="field.value as field.name for field in filter.fields"></select></div><div class="form-group"><input class="form-control" ng-change="filter.update()" type="text" ng-model="object.value" ht-focus=""></div><div class="form-group"><span class="glyphicon glyphicon-remove-circle" ng-click="filter.remove($index)"></span></div></div><button type="button" class="btn btn-default" ng-click="filter.add()">Dodaj filtr</button></div><h4 ng-repeat-start="field in filter.select">{{field.name}}</h4><div class="btn-group" ng-repeat-end=""><label ng-repeat="option in field.options" class="btn btn-success" ng-change="filter.update()" ng-model="option.selected" btn-radio="1" btn-checkbox="">{{option.name}}</label></div>')}]);